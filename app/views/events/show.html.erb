<div>
  <p>
    <h1><%= @event.name %></h1>
    <%= image_tag @event.photo.url(:medium) %></br>
    <%= link_to @event.owner.name, user_path(@event.owner) %>: <%= @event.owner.neighborhood %></br>
  </p>
  <p>
    Location: <%= link_to @event.location, 'http://maps.google.com/?q='+@event.location %></br>
    Date/Time:
      <%= @event.event_date.strftime("%m/%d/%Y ") %>
      <%= @event.event_time.strftime("%I:%M%p") %>
  </p>
  <p><%= @event.description %></p>
</div>

<% if current_user === nil %>
<% elsif current_user == @event.owner || current_user.admin %>
  <div>
   <%= link_to 'Edit Event', edit_event_path(@event), class: 'waves-effect waves-light btn' %>
   <%= link_to 'Delete Event', event_path(@event), method: :delete, :data => {:confirm => 'Are you sure you want to delete this Event?'}, class: 'waves-effect waves-light btn' %>
  </div>
<% end %>

<div>
  <p>
    <%= form_for @new_attendee do |f| %>
      <%= f.hidden_field :event_id, :value => @event.id %>
      <%= f.submit 'JOIN EVENT', class: 'waves-effect waves-light btn' %>
    <% end %>
  </p>
</div>

<!-- ATTENDEES DIV -->
<div>
  <% if @event.attendees.length > 0 %>
  <h1>Attendees</h1>
    <ul>
    <% @event.attendees.each do |attendee|%>
      <li><%= link_to attendee.name, user_path(attendee) %></li>
    <% end %>
    </ul>
  <% end %>
</div>
<!-- END ATTENDEES DIV -->

<div>
  <% if @event.comments.length > 0 %>
    <h1>Comments</h1>
    <% @event.comments.each do |comment|%>
      <!-- COMMENT DIV -->
      <div>

        <div class='toggle show comment<%=comment.id%>'>
          <p>
            <%= link_to comment.owner.name, user_path(comment.owner) %>: <%= comment.owner.neighborhood %></br>
            <%= comment.created_at %>
          </p>
          <p><%= comment.text_body %></p>

          <% if current_user === nil %>
          <% elsif current_user == comment.owner || current_user.admin %>
            <div>
              <%= link_to 'Edit Comment', '#', class: 'toggle edit show',
              id: comment.id %>
              <%= link_to 'Delete Comment', comment_path(comment), method: :delete, :data => {:confirm => 'Are you sure you want to delete this Comment?'}, class: 'toggle show' %>
            </div>
          <% end %>
        </div>

        <div class='toggle hide comment<%=comment.id%>'>
          <%= form_for comment do |f| %>

            <div>
              <p>
                Comment: <%= f.text_field :text_body, placeholder: 'What do you have to say?' %><br/>
              </p>
            </div>

            <div>
              <p><%= link_to 'Cancel', :back, class: 'waves-effect waves-light btn' %></p>
              <p><%= f.submit 'Save Changes', class: 'waves-effect waves-light btn' %></p>
            </div>

          <% end %>
        </div>
      
      </div>
      <!-- END COMMENT DIV -->
    <% end %>
  <% end %>

  <%= form_for @new_comment, :url => comments_path(@new_comment) do |f| %>
    <p><%= f.text_area :text_body, placeholder: 'What do you have to say?' %></p>
    <p><%= f.hidden_field :parent_id, :value => @event.id %></p>
    <p><%= f.hidden_field :parent_type, :value => 'Event' %></p>
    <p><%= f.submit 'Add Comment', class: 'waves-effect waves-light btn' %></p>
  <% end %>
</div>